package fr.bestdevelop.rust.launcher.utils;

import java.io.File;

import com.google.gson.Gson;

import fr.bestdevelop.ml.swinger.exceptions.FailException;
import fr.bestdevelop.ml.swinger.utils.FileUtils;
import fr.bestdevelop.rust.launcher.Launcher;

public class DiskSettings {	
	
	private static Launcher launcher;
	
	private static final Gson gson = new Gson();
	private static File file;
	
	public String username = "Pseudo";
	public int musicVolume = 3;
	public String openNameChanger = "0";
	public String gameExe = "RustClient.exe -show-screen-selector";
	public String steamClient = "steamclient32.dll";
	
	public DiskSettings(File file) {
		DiskSettings.file = file;
		if (file.exists()) {
			DiskSettings.load();
		}
	}
	
	public void save() {
		try {
			FileUtils.writeStringToFile(DiskSettings.file, gson.toJson(this));
		} 
		catch (Exception ex) {
			launcher.logger.warning("Failed to save "+ file.getName(), ex);
			throw new FailException("Failed to save "+ file.getName(), ex);
		}
	}
	
	public static DiskSettings load() {
		File file = DiskSettings.file;
		DiskSettings settings = null;

		try {
			if (file.exists()) {
				settings = gson.fromJson(FileUtils.readFileToString(file), DiskSettings.class);
			}
		} 
		catch (Exception ex) {
			ex.printStackTrace();
		}
		
		if (settings == null) {
			settings = new DiskSettings(DiskSettings.file);
		}
		
		return settings;
	}
}
